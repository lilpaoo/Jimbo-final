<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Jimbo - AI Personal Trainer</title>
  
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  
  <!-- External Stylesheet -->
  <link rel="stylesheet" href="style.css">
  
  <!-- Google API scripts -->
  <script src="https://accounts.google.com/gsi/client" async defer></script>
  <script src="https://apis.google.com/js/api.js" async defer onload="gapiLoaded()"></script>
  
  <!-- SheetJS library for Excel file handling -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  
  <!-- Main Application Script -->
  <script src="script.js" defer></script>
  
</head>
<body>

  <!-- AUTHENTICATION SCREEN -->
  <div id="auth-container">
    <header class="auth-header">
      <div class="auth-logo">
        <img src="images/logo.png" alt="Jimbo Logo">
      </div>
      <nav class="auth-nav">
        <a href="#" class="auth-link">Share Jimbo with friends</a>
      </nav>
    </header>

    <div class="auth-wrapper">
      <div class="auth-box-new">
        <h2>Welcome to Jimbo</h2>
        <p style="margin-bottom: 1.5rem; color: rgba(255,255,255,0.8); font-size: 0.95rem;">
          Your AI-powered personal trainer. Sign in to get started.
        </p>

        <div class="auth-social">
          <div id="google-sign-in-button-placeholder">
             <p style="color: var(--text-light); font-size: 0.9rem;">Loading Sign-In...</p>
          </div>
          
          <div class="auth-or" style="margin: 1rem 0;"><span>OR</span></div>
          
          <button id="tester-login-btn" class="btn-secondary">Login as Tester</button>
        </div>

        <p id="auth-error"></p>
      </div>
    </div>
  </div>

  <!-- MAIN APPLICATION -->
  <div id="main-app-container" class="hidden">
    <!-- SIDEBAR -->
    <aside class="sidebar">
      <div class="logo">
        <img src="images/logo.png" alt="Jimbo">
      </div>
      <nav>
        <div class="nav-item active" data-tab="workout">
          <svg fill="currentColor" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6Zm2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0Zm4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4Zm-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10c-2.29 0-3.516.68-4.168 1.332-.678.678-.83 1.418-.832 1.664h10Z"/></svg>
          <span class="nav-text">Workout Generator</span>
        </div>
        <div class="nav-item" data-tab="nutrition">
           <svg fill="currentColor" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M12.4 1.108a.5.5 0 0 1 .6 0l1.645 1.646a.5.5 0 0 1 0 .707L13.01 5.097l-2.04-2.04 1.43-1.43.001-.001zM11.363 3.15l-8.48 8.482L1.17 13.34l-.493.493a.5.5 0 0 1-.707 0L.01 13.167a.5.5 0 0 1 0-.707l.493-.493 1.708-1.707 8.48-8.481 1.671 1.67zM3 16s.5 0 .5-.5V9.034l.879.879.707-.707L2.021 6.14a.5.5 0 0 0-.707 0L.6 6.857l.707.707L2.186 6.68l.814.814V15.5c0 .5.5.5.5.5zM16 4a.5.5 0 0 1-.5.5h-5a.5.5 0 0 1 0-1h5a.5.5 0 0 1 .5.5z"/></svg>
          <span class="nav-text">Nutrition Generator</span>
        </div>
        <div class="nav-item" data-tab="progress">
           <svg fill="currentColor" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M14 0H2a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2zM2 1a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V1z"/><path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"/></svg>
          <span class="nav-text">Progress Logger</span>
        </div>
        <div class="nav-item" data-tab="form-analysis">
          <svg fill="currentColor" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M0 12V4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2zm15 0a1 1 0 0 0 1-1V4a1 1 0 0 0-1-1H1a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h14z"/><path d="M11.25 5.668a.5.5 0 0 1 .52-.038l3 2.5a.5.5 0 0 1 0 .74l-3 2.5a.5.5 0 0 1-.818-.52l1.232-1.027-1.232-1.027a.5.5 0 0 1 .298-.702zM1 4.25a.75.75 0 0 1 .75-.75h3.5a.75.75 0 0 1 0 1.5h-3.5A.75.75 0 0 1 1 4.25zm0 4a.75.75 0 0 1 .75-.75h3.5a.75.75 0 0 1 0 1.5h-3.5A.75.75 0 0 1 1 8.25zm0 4a.75.75 0 0 1 .75-.75h3.5a.75.75 0 0 1 0 1.5h-3.5a.75.75 0 0 1-.75-.75z"/></svg>
          <span class="nav-text">Form Analysis</span>
        </div>
        <div class="nav-item" data-tab="coach">
          <svg fill="currentColor" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M11 2a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v12h.5a.5.5 0 0 1 0 1H.5a.5.5 0 0 1 0-1H1v-3a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v3h1V7a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v7h1V2zM2 3v10h2V3H2zm4 4v7h2V7H6zm4 0v7h2V7h-2z"/></svg>
          <span class="nav-text">Coach Evaluation</span>
        </div>
      </nav>
      <div class="user-profile">
        <div class="user-avatar">U</div>
        <div>
          <div id="user-email-sidebar" style="font-weight: 600; color: white;">User</div>
          <div style="font-size: 0.8rem; color: var(--text-light);">Member</div>
        </div>
      </div>
    </aside>

    <!-- MAIN CONTENT -->
    <main class="main">
      <header class="header">
        <div>
          <h1 class="title" id="page-title">Workout Generator</h1>
          <p class="subtitle" id="page-subtitle">Your data is saved securely.</p>
        </div>
        <div class="user-info">
          <span id="user-email">user@example.com</span>
          <button class="logout" id="sign-out-btn">Log out</button>
        </div>
      </header>

      <!-- TAB 1: WORKOUT GENERATOR -->
      <section id="workout" class="tab-content active">
        <div class="content">
          <div class="card">
            <h3 class="card-title">Your Details</h3>
            <form id="workout-form">
              <div class="form-group">
                <label class="form-label">Goal</label>
                <select id="goal" class="form-select" required>
                  <option value="">Select...</option>
                  <option value="Fat Loss">Fat Loss</option>
                  <option value="Muscle Gain" selected>Muscle Gain</option>
                  <option value="Strength">Strength</option>
                  <option value="Endurance">Endurance</option>
                </select>
              </div>
              <div class="form-group">
                <label class="form-label">Experience Level</label>
                <select id="experience_level" class="form-select" required>
                  <option value="">Select...</option>
                  <option value="Beginner">Beginner</option>
                  <option value="Intermediate" selected>Intermediate</option>
                  <option value="Advanced">Advanced</option>
                </select>
              </div>
              <div class="form-group">
                <label class="form-label">Days Per Week</label>
                <input type="number" id="days_per_week" class="form-input" min="1" max="7" value="4" required>
              </div>
              <div class="form-group">
                <label class="form-label">Hours Per Day</label>
                <input type="number" id="hours_per_day" class="form-input" step="0.5" min="0.5" max="3" value="1" required>
              </div>
              <div class="form-group">
                <label class="form-label">Available Equipment</label>
                <input type="text" id="available_equipment" class="form-input" placeholder="e.g., dumbbells, bench, pull-up bar" value="Full gym" required>
              </div>
              <button type="submit" class="btn" id="workout-generate-btn">Generate Plan</button>
            </form>
          </div>
          <div class="card">
            <h3 class="card-title">Your Workout Plan</h3>
            <div id="api-response" class="plan-output">Fill in your details and click Generate.</div>
            <button id="save-btn" class="btn" disabled style="margin-top: 1rem;">Save Plan</button>
            <p id="save-status" class="status"></p>
          </div>
        </div>
      </section>

      <!-- TAB 2: NUTRITION GENERATOR -->
      <section id="nutrition" class="tab-content">
        <div class="content">
          <div class="card">
            <h3 class="card-title">Nutrition Details</h3>
            <form id="nutrition-form">
              <div class="form-group">
                <label class="form-label">Goal</label>
                <select id="nutri-goal" class="form-select" required>
                  <option value="">Select...</option>
                  <option value="Fat Loss" selected>Fat Loss</option>
                  <option value="Muscle Gain">Muscle Gain</option>
                  <option value="Maintenance">Maintenance</option>
                </select>
              </div>
              <div class="form-group">
                <label class="form-label">Weight (kg)</label>
                <input type="number" id="nutri-weight" class="form-input" step="0.1" value="85" required>
              </div>
              <div class="form-group">
                <label class="form-label">Height (cm)</label>
                <input type="number" id="nutri-height" class="form-input" value="175" required>
              </div>
              <div class="form-group">
                <label class="form-label">Age</label>
                <input type="number" id="nutri-age" class="form-input" value="30" required>
              </div>
              <div class="form-group">
                <label class="form-label">Activity Level</label>
                <select id="nutri-activity" class="form-select" required>
                  <option value="">Select...</option>
                  <option value="Sedentary">Sedentary</option>
                  <option value="Lightly Active">Lightly Active</option>
                  <option value="Moderately Active" selected>Moderately Active</option>
                  <option value="Very Active">Very Active</option>
                </select>
              </div>
              <div class="form-group">
                <label class="form-label">Dietary Preferences (optional)</label>
                <input type="text" id="nutri-prefs" class="form-input" placeholder="e.g., vegetarian, no dairy">
              </div>
              <button type="submit" class="btn" id="nutrition-generate-btn">Generate Nutrition Plan</button>
            </form>
          </div>
          <div class="card">
            <h3 class="card-title">Your Nutrition Plan</h3>
            <div id="nutrition-response" class="plan-output">Fill in your details and generate.</div>
          </div>
        </div>
      </section>
      
      <!-- TAB 3: PROGRESS LOGGER -->
      <section id="progress" class="tab-content">
        <div class="content">
          <div class="card">
            <h3 class="card-title">Log Check-In</h3>
            <form id="checkin-form">
              <div class="form-group">
                <label class="form-label">Date</label>
                <input type="date" id="checkin-date" class="form-input" required>
              </div>
              <div class="form-group">
                <label class="form-label">Weight (kg)</label>
                <input type="number" id="checkin-weight" class="form-input" step="0.1" placeholder="e.g., 85.5">
              </div>
              <div class="form-group">
                <label class="form-label">Notes</label>
                <textarea id="checkin-notes" class="form-textarea" placeholder="e.g., Completed Day 1, felt strong." required></textarea>
              </div>
              <button type="submit" class="btn">Log Check-In</button>
            </form>
            
            <div id="tester-upload-section" class="hidden" style="margin-top: 2rem; border-top: 1px solid var(--input-border); padding-top: 2rem;">
                 <h4 class="card-title" style="margin-bottom: 1rem;">Load Tester Data</h4>
                 <p style="color: var(--text-light); font-size: 0.9rem; margin-bottom: 1rem;">Upload your `Jimbo_Data.xlsx` file to restore your saved plan and check-ins.</p>
                 <label class="file-input-wrapper" for="upload-data-file">
                    <span id="upload-file-name">Choose .xlsx file...</span>
                    <input type="file" id="upload-data-file" accept=".xlsx" required>
                </label>
                <p id="upload-status" class="status"></p>
            </div>
            
          </div>
          <div class="card">
            <h3 class="card-title">Recent Check-Ins</h3>
            <ul id="checkin-list" class="checkin-list" style="max-height: 400px; overflow-y: auto;">
              <li class="checkin-item">No check-ins yet.</li>
            </ul>
          </div>
        </div>
      </section>

      <!-- TAB 4: FORM ANALYSIS -->
      <section id="form-analysis" class="tab-content">
        <div class="content">
          <div class="card">
            <h3 class="card-title">Analyze Your Form</h3>
            <form id="form-analysis-form">
              <div class="form-group">
                <label class="form-label" for="exercise-select">Exercise</label>
                <select id="exercise-select" class="form-select" required>
                  <option value="">Loading exercises...</option>
                </select>
              </div>
              <div class="form-group">
                <label class="form-label" for="video-upload">Upload Video</label>
                <label class="file-input-wrapper" for="video-upload-real">
                    <span id="file-name-display">Choose a video file...</span>
                    <input type="file" id="video-upload-real" accept="video/mp4,video/mov,video/avi" required>
                </label>
              </div>
              <button type.submit" class="btn" id="analyze-form-btn">Analyze Form</button>
            </form>
          </div>
          <div class="card">
            <h3 class="card-title">Form Analysis Report</h3>
            
            <div id="analysis-progress-container" class="hidden" style="margin-bottom: 1.5rem;">
                <div id="analysis-progress-status" style="font-weight: 500; margin-bottom: 0.5rem; color: var(--text-light);">Uploading...</div>
                <div class="progress-bar-outer">
                    <div id="analysis-progress-bar" class="progress-bar-inner" style="width: 0%;"></div>
                </div>
            </div>

            <div id="form-analysis-response" class="plan-output">
              <p>Please select an exercise and upload a video to get your form analysis.</p>
            </div>
          </div>
        </div>
      </section>

      <!-- TAB 5: COACH EVALUATION -->
      <section id="coach" class="tab-content">
        <div class="content" style="grid-template-columns: 1fr; max-width: 800px; margin: 4rem auto 0;">
          <div class="card" style="text-align:center;">
            <h3 class="card-title">Get Your AI Evaluation</h3>
            <p style="margin: 1rem 0; color: var(--text-light);">
              Click the button to send your saved plan and check-ins to the AI Coach for a progress review.
            </p>
            <button id="evaluate-btn" class="btn" style="max-width: 300px; margin: 1rem auto;">Evaluate Progress</button>
            <h3 class="card-title" style="margin-top: 2rem;">Coach's Report</h3>
            <div id="eval-response" class="plan-output">Evaluation will appear here...</div>
          </div>
        </div>
      </section>
    </main>
  </div>

</body>
</html>